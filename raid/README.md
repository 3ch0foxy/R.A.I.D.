# R.A.I.D. — Threat Hunting Framework

## Project Summary: R.A.I.D.
The R.A.I.D. (Redact | Assess | Integrate | Deploy) project is a lightweight, command-line framework designed to make threat hunting more accessible, flexible, and effective. It was created to solve a key problem: current threat hunting tools are often too complex and rigid for individual users or are too specialized for general use.

### The Core Innovation
R.A.I.D.'s main innovation is its **plugin architecture**. Unlike traditional tools where adding new functions requires changing the core code, R.A.I.D. allows users to easily "plug in" new modules. This means a hunter can add a parser for a new log format or a detector for a brand-new attack technique without ever touching the original tool. This design separates the tool's engine from its detection logic, making it incredibly adaptable.

### Focus on Attacker Behavior (IoA)
Instead of just looking for static clues like bad IP addresses or file hashes (known as IoCs), R.A.I.D. is built to find **Indicators of Attack (IoA)**. IoAs focus on the *actions and intent* of an attacker the sequence of behaviors that signal a malicious campaign. By correlating events over time, R.A.I.D. can spot sophisticated, novel attacks that reactive tools would miss.

### How It Works
The tool processes log files through a simple four-stage workflow:
1. **Redact (Ingest):** Takes in one or more log files.
2. **Assess (Analyze):** Uses plugins to parse the data and hunt for behavioral patterns.
3. **Integrate (Correlate):** Connects the dots between different events to build a coherent story.
4. **Deploy (Report):** Outputs its findings in a simple file format like JSON.

### The Value
R.A.I.D. empowers users—from students to seasoned professionals—by giving them a hands-on tool that bridges the gap between security theory (like the MITRE ATT&CK framework) and practical investigation. It is a dynamic and adaptable "power tool" for the modern threat hunter, providing a platform that can evolve as fast as the threats it is designed to find.

### Important Disclaimer
**R.A.I.D. is a detection tool designed to assist threat hunters and security researchers. The findings and detections generated by this tool are NOT guaranteed to be 100% accurate.** False positives and false negatives may occur based on the detection rules, parser quality, and log data analyzed. 

**Users must independently verify all findings** through manual analysis, additional investigation, and correlation with other security tools and intelligence sources before taking any action. The tool is a starting point for investigation, not a definitive security assessment. Always validate detections with domain expertise and conduct thorough incident response procedures.

**Use at your own risk and responsibility.**

Quick start
-----------
Install development dependencies and the package in editable mode (creates the `raid` console command):

```
python -m pip install --upgrade pip
python -m pip install -r requirements.txt
python -m pip install -e .
```

Running the CLI
---------------
Run via the package module (always works):

```
python -m raid --version
python -m raid --help
python -m raid list
python -m raid run -i path/to/log -p auth_log_parser -d base_detector
python -m raid run -i path/to/folder -p windows_event_log -d windows_event_detector
```

If you installed the package into your active virtualenv (see above), you can run the generated console script directly:

```
raid --version
raid --help
raid list
raid run -i path/to/log -p auth_log_parser -d base_detector
raid run -i path/to/folder -p windows_event_log -d windows_event_detector
```

Input paths (file or folder)
----------------------------
- The `-i/--input` argument accepts either:
	- a single file path, or
	- a folder path (R.A.I.D. will recursively scan files in that folder).
- You can provide multiple `-i` values.

Example (Windows):
```
python -m raid run -i "C:\logs\htb" -p windows_event_log -d windows_event_detector
```
Example (single file):

```
python -m raid run -i "C:\logs\htb\Security.evtx" -p windows_event_log -d windows_event_detector
```

Custom output filename
----------------------
Use `-o/--output` to set your report filename. For example:

```
python -m raid run -i "C:\logs\htb" -p windows_event_log -d windows_event_detector -o report.json
python -m raid run -i "C:\logs\htb" -p windows_event_log -d windows_event_detector -o report.md
```

**Text Format Export (Optional):**

By default, R.A.I.D. generates JSON reports. To export findings in a human-readable text format instead, use the `.txt` extension:

```
python -m raid run -i "C:\logs\htb" -p windows_event_log -d windows_event_detector -o findings.txt
```

This creates a formatted text report with:
- Disclaimer about accuracy and verification requirements
- Summary statistics (findings count, severity distribution)
- Detailed findings with MITRE ATT&CK mappings
- Correlation details (if any)

Report output
-------------
By default, R.A.I.D. generates **JSON reports** with the following structure:

- `summary`
	- `records_processed`
	- `findings_count`
	- `severity_distribution`
	- `correlations_count` (only present when correlations exist)
- `findings`
	- detection metadata (id, severity, detector, event_type, description, MITRE fields)
	- `details` (trimmed to key values)
	- `matched_events_count` (total number of related events)
- `correlations` (only included when non-empty)

**Alternative: Text Format Report**

Use `.txt` extension in the output filename to generate a human-readable text report with the same information formatted for easy review.

Creating Custom Plugins
------------------------
Threat hunters can extend R.A.I.D. by creating custom plugins without modifying the core framework. You can create either a **parser plugin** (to support new log formats) or a **detector plugin** (to identify new attack patterns).

### Step-by-Step Tutorial

#### Step 1: Choose Your Plugin Type

**Parser Plugin**: Use this to add support for a new log file format (e.g., nginx logs, Apache logs, firewall logs).

**Detector Plugin**: Use this to detect new attack patterns or suspicious behaviors in parsed log data.

#### Step 2: Copy the Base Template

**For Parser Plugin:**
1. Navigate to `raid/plugins/parsers/`
2. Copy the template from `base_parser.py`
3. Create your new file: `my_custom_parser.py`

**For Detector Plugin:**
1. Navigate to `raid/plugins/detectors/`
2. Copy the template from `base_detector.py`
3. Create your new file: `my_custom_detector.py`

#### Step 3: Modify the Template

**Example: Custom Detector Plugin**

```python
from typing import List, Dict, Any
from .base_detector import BaseDetector

class MyCustomDetector(BaseDetector):
    def __init__(self):
        super().__init__()
        self.name = "my_custom_detector"  # Change this to your plugin name
        self.description = "Detects my custom attack pattern"  # Describe your plugin
        self.version = "1.0.0"
    
    def get_info(self) -> Dict[str, str]:
        return {
            'name': self.name,
            'description': self.description,
            'version': self.version
        }
    
    def detect(self, data: List[Dict[str, Any]]) -> List[Dict[str, Any]]:
        # Replace NotImplementedError with your detection logic
        findings = []
        
        # Your custom detection logic here
        for record in data:
            if record.get('event_type') == 'suspicious_activity':
                finding = {
                    'id': f"custom_{record.get('id')}",
                    'detector': self.name,
                    'severity': 'high',
                    'event_type': 'custom_threat',
                    'description': 'Detected custom threat pattern',
                    'details': {
                        'record_id': record.get('id'),
                        'timestamp': record.get('timestamp')
                    },
                    'mitre_tactics': ['Initial Access'],
                    'mitre_techniques': ['T1078 - Valid Accounts']
                }
                findings.append(finding)
        
        return findings
```

**Example: Custom Parser Plugin**

```python
from typing import List, Dict, Any
from .base_parser import BaseParser

class MyCustomParser(BaseParser):
    def __init__(self):
        super().__init__()
        self.name = "my_custom_parser"  # Change this to your plugin name
        self.description = "Parses my custom log format"  # Describe your plugin
        self.version = "1.0.0"
    
    def get_info(self) -> Dict[str, str]:
        return {
            'name': self.name,
            'description': self.description,
            'version': self.version
        }
    
    def parse(self, file_path: str) -> List[Dict[str, Any]]:
        # Replace NotImplementedError with your parsing logic
        records = []
        
        # Your custom parsing logic here
        with open(file_path, 'r') as f:
            for line_num, line in enumerate(f, 1):
                # Parse each line and create a record
                record = {
                    'id': f"{file_path}:{line_num}",
                    'timestamp': '2026-01-01T12:00:00',  # Parse actual timestamp
                    'event_type': 'custom_event',
                    'source_ip': '192.168.1.1',  # Extract from log
                    'username': 'user123',  # Extract from log
                    'raw': line.strip()
                }
                records.append(record)
        
        return records
```

#### Step 4: Place Your Plugin in the Correct Folder

- **Parser**: Save in `raid/plugins/parsers/my_custom_parser.py`
- **Detector**: Save in `raid/plugins/detectors/my_custom_detector.py`

#### Step 5: Test Your Plugin

R.A.I.D. automatically discovers your plugin when it starts. No additional registration needed!

```bash
# List all available plugins (yours will appear here)
python -m raid list

# Use your custom plugin
python -m raid run -i "C:\logs\mylog.txt" -p my_custom_parser -d my_custom_detector -o report.json
```

### Important Notes for Plugin Development

1. **Required Methods**:
   - Every plugin must implement `__init__()` and `get_info()`
   - Parsers must implement `parse(file_path)` and return a list of dictionaries
   - Detectors must implement `detect(data)` and return a list of findings

2. **Parser Output Format**:
   - Return a list of dictionaries
   - Each record should include: `id`, `timestamp`, `event_type`, and other relevant fields
   - Include `source_ip` and `username` when available

3. **Detector Output Format**:
   - Return a list of dictionaries (findings)
   - Each finding must include: `id`, `detector`, `severity`, `event_type`, `description`, `details`, `mitre_tactics`, `mitre_techniques`
   - Severity levels: `low`, `medium`, `high`

4. **Plugin Naming**:
   - Use the `self.name` value when running commands (e.g., `-p my_custom_parser`)
   - Plugin names should be lowercase with underscores

5. **Automatic Discovery**:
   - R.A.I.D. automatically loads all `.py` files in the parsers and detectors folders
   - No need to modify core files or register your plugin manually

Notes
-----
- Default logging is quiet (WARNING). Add `-v/--verbose` to see debug/info output.
- If you are developing: after `pip install -e .`, your code changes work right away. Run `pip install -e .` again only if you change project setup files (like `setup.py` or dependencies).